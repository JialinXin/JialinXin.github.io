
<!DOCTYPE html>
<!-- saved from url=(0055)http://weareminky.com/share/ms/docs/conceptual/example/ -->
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="ms.pagetype" content="conceptual" />
    <meta name="ms.sitename" content="DOCS" />
    <meta name="layout" content="Conceptual" />
<meta name="breadcrumb_path" content="/CapsToOpsTest_EMS/v1/toc.json" />
<meta name="_docfxVersion" content="1.4.2.0" />
<meta name="version" content="0" />
<meta name="ms.locale" content="en-us" />
<meta name="locale" content="en-us" />
<meta name="open_to_public_contributors" content="True" />
<meta name="title" content="ATA Prerequisites" />
<meta name="rawTitle" content="&lt;h1 id=&quot;ata-prerequisites&quot;&gt;ATA Prerequisites&lt;/h1&gt;" />
<meta name="ms.custom" content="[
  &quot;ATA&quot;
]" />
<meta name="ms.tgt_pltfrm" content="na" />
<meta name="ms.assetid" content="a5f90544-1c70-4aff-8bf3-c59dd7abd687" />
<meta name="ms.author" content="5f6e9ed0-302d-496f-873c-7a2b94e50410" />
<meta name="keywords" content="na" />
<meta name="search" content="na" />
<meta name="ms.topic" content="article" />
<meta name="pagetitle" content="ATA Prerequisites" />
<meta name="ms.date" content="na" />
<meta name="ms.technology" content="[
  &quot;security&quot;
]" />
<meta name="ms.prod" content="identity-ata" />
<meta name="original_content_git_url" content="https://github.com/kimizhu/CapsToOpsTest_ATA/blob/live/CapsToOpsTest_ATA/v1/Topic/ATA_Prerequisites.md" />
<meta name="content_git_url" content="https://github.com/kimizhu/CapsToOpsTest_ATA/blob/live/CapsToOpsTest_ATA/v1/Topic/ATA_Prerequisites.md" />
<meta name="wordCount" content="1796" />
<meta name="toc_asset_id" content="Topic/TOC.json" />
<meta name="toc_rel" content="TOC.json" />
<meta name="og:image" content="http://docpilot.azurewebsites.net/ATA/_themes/images/logo-ms.png" />

    <title>ATA Prerequisites</title>
    <link rel="stylesheet" href="../_themes/css/conceptual.css">
    <script src="../_themes/javascript/jquery-2.1.4.min.js"></script>
    <script src="../_themes/javascript/docs.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <script src="https://openfeedback.blob.core.windows.net/openfeedback/openfeedback.js"></script>
    <script src="https://cdn.livefyre.com/Livefyre.js"></script>
  </head>
  <body>
    <header id="header" ms.pgarea="header">
      <div id="common-nav-placeholder">
        <div class="container">
          <h3>Microsoft</h3>
          <h5></h5>
        </div>
      </div>
      
      <div id="sub-header" class="container" ms.cmpgrp="breadcrumb">
        <ul class="breadcrumbs"></ul>
      </div>
    </header>

    <div class="container" ms.pgarea="body">

      <aside id="social" ms.cmpgrp="social">
        <ol class="social-actions">
          <li class="menu-theme">
            <div class="dropdown-container">
              <div class="dropdown">
                <select id="theme-selector">
                  <option value="">Light</option>
                  <option value="theme-night">Dark</option>
                  <option value="theme-hot-dog">Hot Dog</option>
                </select>
              </div>
            </div>
          </li>
          <li><a href="" class="button button-small"><span class="icon icon-comments"></span> Comments</a></li>
          <li><a href="https://github.com/kimizhu/CapsToOpsTest_ATA/blob/live/CapsToOpsTest_ATA/v1/Topic/ATA_Prerequisites.md" class="button button-small"><span class="icon icon-edit"></span> Edit</a></li>
          <li><a href="#" class="button button-small sharebutton"><span class="icon icon-share"></span> Share</a></li>
          <div class="share-container">
            <li><a href="" class="share-twitter"><i class="fa fa-fw">&#xf099</i> Twitter</a></li>
            <li><a href="" class="share-facebook"><i class="fa fa-fw">&#xf09a</i> Facebook</a></li>
            <!--<li><a href="" class="share-slack"><i class="fa fa-fw">&#xf198</i> Slack</a></li>-->
          </div>
        </ol>

        <div id="menu-expand">
          <h6><span id="menu-expand-icon">+ </span>Options</h6>
        </div>
      </aside>
      
      <div id="toc" ms.cmpgrp="left toc">
        <nav id="sidebar"></nav>
      </div>
      
      <div id="menu-nav" class="dropdown-container">
        <div class="dropdown dropdown-full mobilenavi">
          <select>
          </select>
        </div>
      </div>

      <div id="main">
        <h1>ATA Prerequisites</h1>
        <div id="metadata" ms.cmpgrp="page info">
          <a href="https://github.com/kimizhu" class="avatar"><span class="author-name" style="background-image: url(https://github.com/kimizhu.png)" alt="Author Name"></span></a>
          <div class="info">
            <span class="name"><a href="https://github.com/kimizhu">jasoz</a></span>
            <div class="meta">
              <time datetime="" class="date">1/4/2016</time>
              <time datetime="" class="reading-time">8 min</time>
              <ul class="contributors">
                
              </ul>
            </div>
          </div> 
        </div>

        <aside class="toc" ms.cmpgrp="intopic toc">
          <h5>In this article</h5>
        </aside>

        <div><div class="content">
<p>This article describes the requirements for a successful deployment of ATA in your environment.</p>
<p>ATA is comprised of two components, the ATA Center and the ATA Gateway. For more information about the ATA components, see <a href="ATA_Architecture.html">ATA Architecture</a>.</p>
<p><a href="#ATAbeforeyoustart">Before you start</a>: This section lists information you should gather and accounts and network entities you should have before starting ATA installation.</p>
<p><a href="#ATAcenter">ATA Center</a>: This section lists ATA Center hardware, software requirements as well as settings  you need to configure on your ATA Center server.</p>
<p><a href="#ATAgateway">ATA Gateway</a>: This section lists ATA Gateway hardware, software requirements as well as settings  you need to configure on your ATA Gateway servers.</p>
<p><a href="#ATAconsole">ATA Console</a>: This section lists browser requirements for running the ATA Console.</p>
<p><img src="http://docspilot.azurewebsites.net/CapsToOpsTest_ATA/v1/Image/ATA_architecture_topology.jpg" alt=""></p>
<h2 id="-a-name-atabeforeyoustart-a-before-you-start"><a name="ATAbeforeyoustart"></a>Before you start</h2>
<p>This section lists information you should gather and accounts and network entities you should have before starting ATA installation.</p>
<ul>
<li><p><strong>Domain controllers</strong> running on Windows Server 2008 and later.</p>
</li>
<li><p><strong>User account and password</strong> with read access to <strong>all objects</strong> in the domains that will be monitored.</p>
<div class="NOTE"><h5>NOTE</h5><p>If you have set custom ACLs on various Organizational Units (OU) in your domain, make sure that the selected user has read permissions to those OUs.</p>
</div>
<p> Optional: User should have read only permissions on the Deleted Objects container. This will allow ATA to detect bulk deletion of objects in the domain. For information about configuring read only permissions on the Deleted Objects container, see the <strong>Changing permissions on a deleted object container</strong> section in the <a href="https://technet.microsoft.com/library/cc816824%28v=ws.10%29.aspx">View or Set Permissions on a Directory Object</a> topic.</p>
</li>
<li><p>Optional: A user account of a user who has no network activities. This account will be configured as the ATA Honeytoken user. To configure the Honeytoken user you will need the SID of the user account, not the username.</p>
</li>
<li><p>Optional: In addition to collecting and analyzing network traffic to and from the domain controllers, ATA can use Windows event 4776 to further enhance ATA Pass-the-Hash detection. This can be received from your SIEM or by  setting Windows Event Forwarding from your domain controller. Events collected provide ATA with additional information that is not available via the domain controller network traffic.</p>
</li>
<li><p>It may be useful for you to have a list of all subnets used on your network for VPN and Wi-Fi, which reassign IP addresses between devices within a very short period of time (seconds or minutes).  You will want to identify these short-term lease subnets so that ATA can reduce their cache lifetime to accommodate the fast re-assignment between devices. See <a href="Install_ATA.html">Install ATA</a> for short-term lease subnet configuration.</p>
</li>
</ul>
<h2 id="-a-name-atacenter-a-ata-center-requirements"><a name="ATAcenter"></a>ATA Center requirements</h2>
<p>This section lists the requirements for the ATA Center.</p>
<p>The ATA Center supports installation on a server running Windows Server 2012 R2. Run Windows Update and make sure all important updates are installed. 
 The number of domain controllers you are monitoring and the load on each of the domain controllers dictates the hardware requirements.</p>
<p>Installation of the ATA Center as a virtual machine is supported. For more information see <a href="Configure_Port_Mirroring.html">Configure Port Mirroring</a>.</p>
<p>If you run the ATA Center as a virtual machine, shut down the server before creating a new checkpoint to avoid potential database corruption.</p>
<div class="NOTE"><h5>NOTE</h5><p>The ATA Center can be installed on a server that is a member of a domain or workgroup.</p>
</div>
<p><strong>Minimum requirements</strong></p>
<ul>
<li><p>CPU -  8 cores</p>
</li>
<li><p>Memory - 48 GB</p>
</li>
<li><p>Storage - 1000 GB per month to monitor 2 lightly loaded domain controllers</p>
</li>
</ul>
<p>The ATA Center requires a minimum of 21 days of data for user behavioral analytics. For more information on hardware requirements, see <a href="ATA_Capacity_Planning.html">ATA Capacity Planning</a>.</p>
<div class="NOTE"><h5>NOTE</h5><p>If you want to install ATA in a lab with a few VMs, it is recommended that you have at least 2 cores, 4 GB of RAM and 100GB of storage to allow you to interact with the ATA Console without support for production deployment.</p>
</div>
<h3 id="time-synchronization">Time synchronization</h3>
<p>The ATA Center server,  the ATA Gateway servers and the domain controllers must have time synchronized to within 5 minutes of each other.</p>
<h3 id="bios-settings">BIOS settings</h3>
<p>The ATA database necessitates that you <strong>disable</strong> Non-uniform memory access (NUMA) in the BIOS. Your system may refer to NUMA as Node Interleaving, in which case you will have to <strong>enable</strong> Node Interleaving. See your BIOS documentation for more information.</p>
<h3 id="network-adapters">Network adapters</h3>
<p>Requirements:</p>
<ul>
<li><p>One network adapter</p>
</li>
<li><p>Two IP addresses</p>
</li>
</ul>
<p>Communication between the ATA Center and the ATA Gateway is encrypted using SSL on port 443. Additionally, the ATA Console runs on IIS and is secured using SSL on port 443. <strong>Two IP addresses</strong> are recommended. The ATA Center service will bind port 443 to the first IP address and IIS will bind port 443 to the second IP address.</p>
<div class="NOTE"><h5>NOTE</h5><p>A single IP address with two different ports can be used, but two IP addresses are recommended.</p>
</div>
<h3 id="ports">Ports</h3>
<p>The following table lists the minimum ports that have to be opened for the ATA Center to work properly.</p>
<p>In this table, IP address 1 is bound to the ATA Center service and IP address 2 is bound to the IIS service for the ATA Console.</p>
<table>
<thead>
<tr>
<th>Protocol <br> <br></th>
<th>Transport <br> <br></th>
<th>Port <br> <br></th>
<th>To/From <br> <br></th>
<th>Direction <br> <br></th>
<th>IP Address <br> <br></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SSL</strong> (ATA Communications) <br> <br></td>
<td>TCP <br> <br></td>
<td>443, or configurable <br> <br></td>
<td>ATA Gateway <br> <br></td>
<td>Inbound <br> <br></td>
<td>IP address 1 <br> <br></td>
</tr>
<tr>
<td><strong>HTTP</strong> <br> <br></td>
<td>TCP <br> <br></td>
<td>80 <br> <br></td>
<td>Company Network <br> <br></td>
<td>Inbound <br> <br></td>
<td>IP address 2 <br> <br></td>
</tr>
<tr>
<td><strong>HTTPS</strong> <br> <br></td>
<td>TCP <br> <br></td>
<td>443 <br> <br></td>
<td>Company Network and ATA Gateway <br> <br></td>
<td>Inbound <br> <br></td>
<td>IP address 2 <br> <br></td>
</tr>
<tr>
<td><strong>SMTP</strong> (optional) <br> <br></td>
<td>TCP <br> <br></td>
<td>25 <br> <br></td>
<td>SMTP Server <br> <br></td>
<td>Outbound <br> <br></td>
<td>IP address 2 <br> <br></td>
</tr>
<tr>
<td><strong>SMTPS</strong> (optional) <br> <br></td>
<td>TCP <br> <br></td>
<td>465 <br> <br></td>
<td>SMTP Server <br> <br></td>
<td>Outbound <br> <br></td>
<td>IP address 2 <br> <br></td>
</tr>
<tr>
<td><strong>Syslog</strong> (optional) <br> <br></td>
<td>TCP <br> <br></td>
<td>514 <br> <br></td>
<td>Syslog server <br> <br></td>
<td>Outbound <br> <br></td>
<td>IP address 2 <br> <br></td>
</tr>
</tbody>
</table>
<h3 id="certificates">Certificates</h3>
<p>Make sure the ATA Gateways have access to your CRL distribution point. If the ATA Gateways don&#39;t have Internet access, follow <a href="https://technet.microsoft.com/en-us/library/aa996972%28v=exchg.65%29.aspx">the procedure to manually import a CRL</a>, taking care to install the all the CRL distribution points for the whole chain.</p>
<p>To ease the installation of the ATA Center, you can install self-signed certificates during the installation of the ATA Center. Post deployment you can replace the self-signed with a certificate from an internal Certification Authority to be used by the ATA Gateway.</p>
<div class="NOTE"><h5>NOTE</h5><p>Self-signed certificates should be used only for lab deployment.</p>
</div>
<p>The ATA Center requires certificates for the following services:</p>
<ul>
<li><p>Internet Information Services (IIS) – Web server certificate</p>
</li>
<li><p>ATA Center service – Server authentication certificate</p>
</li>
</ul>
<div class="NOTE"><h5>NOTE</h5><p>If you are going to access the ATA Console from other computers, ensure that those computers trust the certificate being used by IIS otherwise you will get a warning page that there is a problem with the website&#39;s security certificate before getting to the log in page.</p>
</div>
<h2 id="-a-name-atagateway-a-ata-gateway-requirements"><a name="ATAgateway"></a>ATA Gateway requirements</h2>
<p>The ATA Gateway supports installation on a server running Windows Server 2012 R2.</p>
<p>Run Windows Update and make sure all <strong>Important</strong> updates have been installed. 
Before installing ATA Gateway confirm that the following update has been installed: <a href="https://support.microsoft.com/en-us/kb/2919355/">KB2919355</a>.</p>
<p>You can check by running the following Windows PowerShell cmdlet: <code>[Get-HotFix -Id kb2919355]</code>.</p>
<div class="NOTE"><h5>NOTE</h5><ul>
<li>The ATA Gateway can be installed on a server that is a member of a domain or workgroup.</li>
<li>The ATA Gateway cannot be installed on a domain controller.</li>
</ul>
</div>
<p>For information on using virtual machines with the ATA Gateway, see <a href="Configure_Port_Mirroring.html">Configure Port Mirroring</a>.</p>
<div class="NOTE"><h5>NOTE</h5><p>If you run the ATA Gateway as a virtual machine, shut down the server before creating a new checkpoint to avoid potential database corruption.</p>
</div>
<p>An ATA Gateway can support monitoring multiple domain controllers, depending on the amount of network traffic to and from the domain controllers.</p>
<p><strong>Minimum requirements:</strong></p>
<ul>
<li><p>CPU - 4 cores</p>
</li>
<li><p>Memory - 8 GB</p>
</li>
<li><p>Storage - Enough for the OS + 10GB for ATA + crash dumps = at least 100 GB</p>
</li>
</ul>
<p>For more information, see <a href="ATA_Capacity_Planning.html">ATA Capacity Planning</a>.</p>
<h3 id="power-settings">Power settings</h3>
<p>For optimal performance, set the <strong>Power Option</strong> of the ATA Gateway to <strong>High Performance</strong>.</p>
<h3 id="time-synchronization">Time synchronization</h3>
<p>The ATA Center server and the ATA Gateway server must have time synchronized to within 5 minutes of each other.</p>
<p>In addition, The ATA Gateway and the domain controllers to which it connects must have time synchronized to within 5 minutes of each other.</p>
<h3 id="network-adapters">Network adapters</h3>
<p>The ATA Gateway requires at least one Management adapter and at least one Capture adapter:</p>
<ul>
<li><p><strong>Management adapter</strong> - will be used for communications on your corporate network. This adapter should be configured with the following:</p>
<ul>
<li><p>Static IP address including default gateway</p>
</li>
<li><p>Preferred and alternate DNS servers</p>
</li>
<li><p>The <strong>DNS suffix for this connection</strong> should be the DNS name of the domain for each domain being monitored.</p>
<p> <img src="http://docspilot.azurewebsites.net/CapsToOpsTest_ATA/v1/Image/ATA_DNS_Suffix.png" alt=""></p>
<div class="NOTE"><h5>NOTE</h5><p>If the ATA Gateway is a member of the domain, this is configured automatically.</p>
</div>
</li>
</ul>
</li>
<li><p><strong>Capture adapter</strong> - will be used to capture traffic to and from the domain controllers.</p>
<div class="IMPORTANT"><h5>IMPORTANT</h5><ul>
<li>Configure port mirroring for the capture adapter as the destination of the domain controller network traffic. See <a href="Configure_Port_Mirroring.html">Configure Port Mirroring</a>  for additional information. Typically, you will need to work with the networking or virtualization team to configure port mirroring.</li>
<li>Configure a static non-routable IP address for your environment with no default gateway and no DNS server addresses. For example, 1.1.1.1/32. This will ensure that the capture network adapter can capture the maximum amount of traffic and that the management network adapter is used to send and receive the required network traffic.</li>
</ul>
</div>
</li>
</ul>
<h3 id="ports">Ports</h3>
<p>The following table lists the minimum ports that the ATA Gateway requires configured on the management adapter.</p>
<table>
<thead>
<tr>
<th>Protocol <br> <br></th>
<th>Transport <br> <br></th>
<th>Port <br> <br></th>
<th>To/From <br> <br></th>
<th>Direction <br> <br></th>
</tr>
</thead>
<tbody>
<tr>
<td>LDAP <br> <br></td>
<td>TCP and UDP <br> <br></td>
<td>389 <br> <br></td>
<td>Domain controllers <br> <br></td>
<td>Outbound <br> <br></td>
</tr>
<tr>
<td>Secure LDAP (LDAPS) <br> <br></td>
<td>TCP <br> <br></td>
<td>636 <br> <br></td>
<td>Domain controllers <br> <br></td>
<td>Outbound <br> <br></td>
</tr>
<tr>
<td>LDAP to Global Catalog <br> <br></td>
<td>TCP <br> <br></td>
<td>3268 <br> <br></td>
<td>Domain controllers <br> <br></td>
<td>Outbound <br> <br></td>
</tr>
<tr>
<td>LDAPS to Global Catalog <br> <br></td>
<td>TCP <br> <br></td>
<td>3269 <br> <br></td>
<td>Domain controllers <br> <br></td>
<td>Outbound <br> <br></td>
</tr>
<tr>
<td>Kerberos <br> <br></td>
<td>TCP and UDP <br> <br></td>
<td>88 <br> <br></td>
<td>Domain controllers <br> <br></td>
<td>Outbound <br> <br></td>
</tr>
<tr>
<td>Netlogon <br> <br></td>
<td>TCP and UDP <br> <br></td>
<td>445 <br> <br></td>
<td>Domain controllers <br> <br></td>
<td>Outbound <br> <br></td>
</tr>
<tr>
<td>Windows Time <br> <br></td>
<td>UDP <br> <br></td>
<td>123 <br> <br></td>
<td>Domain controllers <br> <br></td>
<td>Outbound <br> <br></td>
</tr>
<tr>
<td>DNS <br> <br></td>
<td>TCP and UDP <br> <br></td>
<td>53 <br> <br></td>
<td>DNS Servers <br> <br></td>
<td>Outbound <br> <br></td>
</tr>
<tr>
<td>NTLM over RPC <br> <br></td>
<td>TCP <br> <br></td>
<td>135 <br> <br></td>
<td>All devices on the network <br> <br></td>
<td>Outbound <br> <br></td>
</tr>
<tr>
<td>NetBIOS <br> <br></td>
<td>UDP <br> <br></td>
<td>137 <br> <br></td>
<td>All devices on the network <br> <br></td>
<td>Outbound <br> <br></td>
</tr>
<tr>
<td>SSL <br> <br></td>
<td>TCP <br> <br></td>
<td>443 or as configured for the Center Service <br> <br></td>
<td>ATA Center: <br> <br><ul><li>Center Service IP Address </li><li>IIS IP Address </li> </ul></td>
<td>Outbound <br> <br></td>
</tr>
<tr>
<td>Syslog (optional) <br> <br></td>
<td>UDP <br> <br></td>
<td>514 <br> <br></td>
<td>SIEM Server <br> <br></td>
<td>Inbound <br> <br></td>
</tr>
</tbody>
</table>
<div class="NOTE"><h5>NOTE</h5><p>As part of the resolution process done by the ATA Gateway, the following ports need to be open inbound on devices on the network from the ATA Gateways.</p>
<ul>
<li>NTLM over RPC</li>
<li>NetBIOS</li>
</ul>
</div>
<h3 id="certificates">Certificates</h3>
<p>To ease installation of the ATA Center, you can install self-signed certificates during the installation of the ATA Center. Post deployment you can replace the self-signed with a certificate from an internal Certification Authority to be used by the ATA Gateway.</p>
<div class="NOTE"><h5>NOTE</h5><p>Self-signed certificates should be used only for lab deployment.</p>
</div>
<p>A certificate supporting <strong>Server Authentication</strong> is required to be installed in the Computer store of the ATA Gateway in the Local Computer store. This certificate must be trusted by the ATA Center.</p>
<h2 id="-a-name-ataconsole-a-ata-console"><a name="ATAconsole"></a>ATA Console</h2>
<p>Access to the ATA Console is via a browser, supporting the following:</p>
<ul>
<li><p>Internet Explorer version 10 and above</p>
</li>
<li><p>Google Chrome  40 and above</p>
</li>
<li><p>Minimum screen width resolution of 1700 pixels</p>
</li>
</ul>
<h2 id="see-also">See Also</h2>
<p><a href="ATA_Architecture.html">ATA Architecture</a>
<a href="Install_ATA.html">Install ATA</a>
<a href="https://social.technet.microsoft.com/Forums/security/en-US/home?forum=mata">For support, check out our forum!</a></p>
</div></div>

      </div>
    </div>

    <div id="openFeedbackContainer" class="openfeedback-container"></div>
    <div id="comments-container" class="container"></div>
    
    <footer id="footer" ms.pgarea="footer">
      <div class="container">
        <a href="http://www.microsoft.com/" class="logo"><img src="http://localhost/CapsToOpsTest_ATA/v1/_themes/images/logo-ms.png" alt="Microsoft"></a>
        <ul class="links" ms.cmpgrp="footer link">
          <li><a href="">Contact Us</a></li>
          <li><a href="">Privacy Statement</a></li>
          <li><a href="">Terms of Use</a></li>
          <li><a href="">Trademarks</a></li>
        </ul>
      </div>
    </footer>

    <script>
        //commenting configurations.
        window.commentOptions = {
            network: "microsoft-ssodemo.fyre.co",
            siteId: "305985",
            containerElementId: "comments-container",
            documentIdMetaName: "ms.assetid",
            sidenoteSelectors: "",
            localeMetaName: "ms.locale"
        };
    </script>

    <script src="../_themes/javascript/conceptual.js"></script>
    <script src="../_themes/javascript/insight.js"></script>
    <script src="../_themes/javascript/rating.js"></script>
    <script src="https://openfeedback.blob.core.windows.net/commenting/comment.js"></script>
</body></html>
